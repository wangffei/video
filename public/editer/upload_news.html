<!doctype html>
<html>
	<head>
	    <title>上传歌曲</title>
	    <link rel="stylesheet" href="../layui/css/layui.css">
	    <style>
            .layui-form-label {
                width: 100px;
            }
        </style>
	</head>

	<body>
		<form class="layui-form" action="" style="width:500px;margin:50px auto 0 ;background:gray;padding:10px;">
			<div class="layui-form-item">
                <label class="layui-form-label" style="font-weight: bold; font-size: 18px; width: 120px;">发表文章<br/></label>
			</div>
			<div class="layui-form-item">
			    <label class="layui-form-label">&nbsp;&nbsp;主标题:</label>
			    <div class="layui-input-inline">
			      <input type="text" name="heading" required lay-verify="required" placeholder="请输入主标题" autocomplete="off" class="layui-input">
			    </div>
			    <!--<div class="layui-form-mid layui-word-aux">辅助文字</div>-->
			</div>
			<div class="layui-form-item">
			    <label class="layui-form-label">&nbsp;&nbsp;副标题:</label>
			    <div class="layui-input-inline">
			      <input type="text" name="sub_heading" placeholder="请输入副标题" autocomplete="off" class="layui-input">
			    </div>
			</div>
			<div class="layui-form-item">
			    <label class="layui-form-label">文章标签:</label>
			    <div class="layui-input-block">
			        <button type="button" class="layui-btn" id="tag" style="float: left;">
			            <i class="layui-icon">&#xe608;</i> 添加标签
			        </button>
			    </div>
			</div>
			<div class="layui-form-item">
			    <label class="layui-form-label">封面:</label>
			    <div class="layui-input-block">
			        <button type="button" class="layui-btn upload_item" id="cover" style="float: left;">
			          <i class="layui-icon">&#xe67c;</i>上传图片
			        </button>
			    </div>
			</div>
			<input id="editormd-image-file" type="hidden" name="cover_file"/>
			<div class="layui-form-item">
			    <label class="layui-form-label"></label>
			</div>
			<div class="layui-form-item">
			    <div class="layui-input-block" style="width: 300px;">
			        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
			        <button type="button" class="layui-btn layui-btn-primary">保存为草稿</button>
			        <button type="button" id="updateRole" class="layui-btn layui-btn-normal" lay-submit lay-filter="formDemo">发布文章</button>
			    </div>
			</div>
		</form>
		<div id="upload1" style="display:none;"></div>
		<script src="../layui/layui.all.js"></script>
		<script>
		var $ = layui.jquery ;
		layui.use('upload', function(){
		  var upload = layui.upload;
		  //执行实例
		  var uploadInst = upload.render({
		    elem: '#upload1' //绑定元素
		    ,url: '/api/uploadImage' //上传接口
		    ,accept:"images"
		    ,done: function(res){
		      $("#editormd-image-file").val(res.data.file)
		    }
		    ,error: function(){
		      //请求异常回调
		    }
		  });
		});
		$(".upload_item").click(function(){
			if($(this).attr("id") == "music"){
				document.getElementById("upload1").click()
			}
		})
		</script>
		<script>
		//Demo
		layui.use('form', function(){
		  var form = layui.form;
		  
		  //监听提交
		  form.on('submit(formDemo)', function(data){
		    $.ajax({
		    	url:"/api/upload_news" ,
		    	data:data.field ,
		    	success:function(res){
		    		if(res.code == 200){
		    			layer.msg("成功")
		    		}else{
		    			layer.msg(res.msg)
		    		}
		    	} ,
		    	fail:function(){
		    		layer.msg("请求失败")
		    	}
		    })
		    return false;
		  });
		});
		</script>
	</body>

</html>